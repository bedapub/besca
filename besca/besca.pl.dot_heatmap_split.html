

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>dot_heatmap_split &mdash; BESCA 2.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> BESCA
          

          
          </a>

          
            
            
              <div class="version">
                2.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../besca.html">besca</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html">code examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../besca_standard_pipeline.html">standard pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../adding_new_functions.html">adding new functions to besca</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BESCA</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>dot_heatmap_split</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/besca/besca.pl.dot_heatmap_split.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="dot-heatmap-split">
<h1>dot_heatmap_split<a class="headerlink" href="#dot-heatmap-split" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="besca.pl.dot_heatmap_split">
<code class="descclassname">besca.pl.</code><code class="descname">dot_heatmap_split</code><span class="sig-paren">(</span><em>adata, genes, split_by, group_by='louvain', plot_absolute=True, raw=True, color_maps=['Reds', 'Blues'], figsize=None, order=None, switch_axis=False, rotation=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/besca/pl/_dot_heatmap.html#dot_heatmap_split"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#besca.pl.dot_heatmap_split" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a dot plot, filled with heatmap of individuals cells gene expression to compare two conditions.</p>
<p>This function generates a plot where the genes are plotted on the X-axis and the groups on
the y-axis. For each coordinate two side-by-side circle plots are generated where the size of the circle
represents the number of cells in the group and the fill of the circle shows the gene
expression of each individual cell as a sorted heatmap. The two circles represent the cells in that group
from each condition.</p>
<p>If switch_axis = True then the genes are plotted on the y-axis and the groups on the x-axis.</p>
<p>Note this function takes some time to calculate depending on the number of individual points
that need to be plotted.</p>
<p>Note: currently this function is only implemented to support pairwise comparisions (i.e. with a maximum of
two groups)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>adata</strong> (<cite>AnnData</cite>) – anndata object containing data that is to be visualized</li>
<li><strong>genes</strong> (<cite>[‘str’]</cite>) – list of strings identifying the genes that are to be plotted</li>
<li><strong>split_by</strong> (<cite>str</cite>) – string identifying the column in adata.obs that is to be used to identify the two conditions.
May only contain two different labels.</li>
<li><strong>group_by</strong> (<cite>str</cite> | default = ‘louvain’) – string identifying the column in adata.obs that is to be used to generate the groups</li>
<li><strong>plot_absolute</strong> (<cite>bool</cite> | default) – boolian value used to indicate if the absolute geneexpression or the relativ gene expression
should be plotted (currently not fully implemented)</li>
<li><strong>raw</strong> (<cite>bool</cite> | default = True) – boolian value indicating if the data saved in adata.raw should be used to generate the plot</li>
<li><strong>color_map</strong> (<cite>str</cite>) – string identifying the type of color_map that should be used to plot the results (needs to exist!)</li>
<li><strong>figsize</strong> (<em>(</em><em>value</em><em>, </em><em>value</em><em>) or </em><em>None | default = None</em>) – optional parameter to define the figure size of the plot that is to be generated</li>
<li><strong>order</strong> (<cite>[‘str’]</cite> or None | default = None) – optional parameter to pass an ordered list of groups to the function to specify the order in which
they are to be plotted</li>
<li><strong>switch_axis</strong> (<cite>bool</cite> | default = False) – boolian value to determine if the axes should be switched. Per default the genes are plotted on the
x-axis.</li>
<li><strong>rotation</strong> (<cite>int</cite>) – optional parameter to define by which degree the labels on the x-axis should be rotatet. Per default
this is 0 if the genes are plotted on the x-axis and 90 if the group labels are plotted on the x-axis.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A matplotlib figure element containing the generated plot. To save the figure this plot will need
to be passed to a parameter and saved in a second step through the fig.savefig() function call.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Figure</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#import libraries and dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">besca</span> <span class="k">as</span> <span class="nn">bc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adata</span> <span class="o">=</span> <span class="n">bc</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">pbmc_storage_processed</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#filter out one donor to have two &quot;conditions&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adata</span> <span class="o">=</span> <span class="n">adata</span><span class="p">[</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">donor</span> <span class="o">!=</span> <span class="s1">&#39;Donor_3A&#39;</span><span class="p">,:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># define genes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">genes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CD3D&#39;</span><span class="p">,</span> <span class="s1">&#39;TMSB4X&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">bc</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">dot_heatmap_split</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">genes</span><span class="o">=</span><span class="n">genes</span><span class="p">,</span> <span class="n">group_by</span><span class="o">=</span><span class="s1">&#39;louvain&#39;</span><span class="p">,</span> <span class="n">split_by</span> <span class="o">=</span> <span class="s1">&#39;donor&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../besca/besca-pl-dot_heatmap_split-1.py">Source code</a>)</p>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, BEDA

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>