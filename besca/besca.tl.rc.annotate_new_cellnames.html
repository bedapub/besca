

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>annotate_new_cellnames &mdash; BESCA 2.3 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-dataframe.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> BESCA
          

          
          </a>

          
            
            
              <div class="version">
                2.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../besca.html">besca</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html">code examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../besca_standard_pipeline.html">standard pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../adding_new_functions.html">adding new functions to besca</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BESCA</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>annotate_new_cellnames</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/besca/besca.tl.rc.annotate_new_cellnames.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="annotate-new-cellnames">
<h1>annotate_new_cellnames<a class="headerlink" href="#annotate-new-cellnames" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="besca.tl.rc.annotate_new_cellnames">
<code class="sig-prename descclassname">besca.tl.rc.</code><code class="sig-name descname">annotate_new_cellnames</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">adata</span></em>, <em class="sig-param"><span class="n">cluster_subset</span></em>, <em class="sig-param"><span class="n">names</span></em>, <em class="sig-param"><span class="n">new_label</span><span class="o">=</span><span class="default_value">'celltype'</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'leiden'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/besca/tl/rc/_reclustering.html#annotate_new_cellnames"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#besca.tl.rc.annotate_new_cellnames" title="Permalink to this definition">¶</a></dt>
<dd><p>annotate new cellnames to each of the subclusters identified by running recluster.</p>
<p>Give each subcluster a new celltype identifier. Can only be run on an AnnData subset that has already been
reclustered, e.g. using the recluster function also available in this package. The list of
provided names must be of equal length to the number of subclusters in the AnnData subset.
The order must be the same as the order of the clusters identifiers (integer expected).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> – complete AnnData object from which the subset was extracted. Must contain adata.obs.celltype.</p></li>
<li><p><strong>cluster_subset</strong> – AnnData subset on which a reclustering has been run. Must contain adata.obs.celltype.</p></li>
<li><p><strong>names</strong> (<cite>[str]</cite>) – list of strings containing the new celltype annotation. Order and Length must mach the
lexicographic order of the louvain clusters in the AnnData susbet.</p></li>
<li><p><strong>celltype_label</strong> – </p></li>
<li><p><strong>new_label</strong> (<cite>str</cite> | default = ‘celltype’) – string specifying under which label in adata.obs the new annotation should be saved
(it will overwrite existing annotations under this name)</p></li>
<li><p><strong>method</strong> (<cite>str</cite> | default = ‘leiden’) – <p>string indicating the method used for clustering. This string will be used to retrieve the cluster
numbers</p>
<blockquote>
<div><p>in adata.obs and in the cluster_subset. (assuming the same obs column name)</p>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Complete AnnData object with the new celltype annotations in the adata.obs.new_label column for</em></p></li>
<li><p><em>the subclusters.</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Please refer to the code examples section of the documentation for a complete example of
the reclustering process.</p>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, BEDA

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>